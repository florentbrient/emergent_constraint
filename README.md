# Statistical inference of emergent constraints
__This project aims to provide statistical inferences for emergent constraints.__  
Git project creation 12 Feb 2019  
[![DOI](https://zenodo.org/badge/170500952.svg)](https://zenodo.org/doi/10.5281/zenodo.10886173)

Statistical inferences consists in two methods:  

The first uses uncertainties underlying the observational predictor and project it onto the vertical axis using the emergent constraint relationship  
The second consists of estimating a posterior distribution by weighting each model's response by the likelihood of the model given the observations of the predictor. This can be done through information theory, i.e. the Kullback-Leibler divergence as coded in [Brient and Schneider (16)](https://journals.ametsoc.org/doi/full/10.1175/JCLI-D-15-0897.1).

The routines have been used in a peer-reviewed article :

Brient 2019, *Reducing uncertainties in climate projections with emergent constraints: Concepts, Examples and Prospects*, Advances in Atmospheric Sciences (DOI:10.1007/s00376-019-9140-8). See preprint article on [EarthAriXiv](https://eartharxiv.org/qwbyt) 

Authors : F. Brient, T. Schneider

## Description

### Main directory
The main repository contains this __README.md__ file and three folders: __src__, __text__ and __figures__.

### src/
The src folder contains the Python modules

-*plot_random_EC.py*  
  This routine is used to calculcate statistical inferences from an M idealized randomly-generated relationships between and predictor A and a predictand B for N models. 

  The random statistical relationship is generated as follows:

    * Arbitrary values for the predictor x are linearly distributed between x1 and x2 for the N models
    * The predictand y follows the idealized relationship (y'=ax+b) with boundaries y1 and y2
    * A random deviation Delta_y is applied to y' that follows a normal distribution
    * Number of models (N) and the randomness of the relationship (rdm) can be chosen


  The idealized observational estimate used for the inference is generated as a normal distribution given mean and &sigma;<sub>obs</sub>.

  Posterior estimates are calculated with two methods:
   - The posterior distribution based on the slope is performed through observation inference from 10<sup>4</sup> bootstrap model samples plus a normal noise term
   - The second posterior distribution is obtained by a weighted average of the models through a Kullback-Leibler divergence. In that purpose, we assume the same uncertainty &sigma;<sub>obs</sub> between models and observation.

  Confidence intervals are calculated the prior distribution and both posterior distributions for the M idealized relationships. Statistics are written on the *statistics.txt* file on the __text__ folder and contains the slope, the correlation coefficient, mode and confidence intervals of prior and posterior distributions. A figure can be plotted the flag is on.


-*binning_inference.py*

  This routine uses the set of M inferences from the randomly-generated relationships listed on the *statistics.txt* files to generate a composite analysis. The figure shows the mean relationship between modes of prior and posterior distributions and correlation coefficient bins. Average mode, average 66% confidence intervals and standard deviation of modes across the set of emergent relationship are shown.


-*plot_PDF_ECS.py*

  This routines create normal distributions with mean and standard deviation provided by several emergent constraints on equilibrium climate sensitivity listed on the litterature. 

  Two unweighted and weighted density distributions aggregated over the emergent constraints are calculated. Weights are defined as the reciprocal of the variance of each emergent constraint, which correspond to an optimal weighting method under the assumption that distributions are independent and normally distributed.

  The prior CMIP3 and CMIP5 and the posterior means and standard deviations are listed on the *data_ECS.txt* file. 




### text/
List of text files.

Inputs:
 - data_ECS.txt
 - statistics_r2.0.10000.txt

Outputs:
 - statistics.txt

### figures/
This folder gathers figures generated by routines in __src__:

 - modes_prior_post.png
 - PDF_emergent_constraints.png
 - filename_random.png
